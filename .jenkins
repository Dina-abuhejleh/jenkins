pipeline {
    agent any
    stages {
           stage("set variables"){
               steps{
                   script{
                       env.city=sh "free -m | awk 'NR==2{printf \"%.2f%%\",\$3*100/\$2}'"
                   }
               }
           }
        stage('Build') {
            steps {
                 sh 'hostname'
                 sh 'free -m'
                 echo "Running ${env.BUILD_ID}"
                 sh 'w'
                 echo "${env.city}"
            }
        }     
    }
}
